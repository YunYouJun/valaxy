import type { PartialDeep } from 'type-fest'
import type { VitePluginConfig } from 'unocss/vite'
import type { MarkdownOptions } from '../node/markdown'
import type { ViteMdOptions } from '../node/plugins/markdown'

export type ValaxyThemeConfig = Record<string, any>

export interface SocialLink {
  /**
   * The title of your link
   */
  name: string
  link: string
  /**
   * å›¾æ ‡åç§°
   * https://icones.js.org/
   */
  icon: string
  color: string
}

export interface ValaxyConfig<T = ValaxyThemeConfig> {
  /**
   * Default language
   * @description é»˜è®¤è¯­è¨€
   * @default 'en'
   */
  lang: string
  /**
   * You site url in web, required for ssg & rss
   * @description ç«™ç‚¹çš„ URLï¼ŒSSG & RSS éœ€è¦ï¼ˆè­¬å¦‚ç”Ÿæˆç‰ˆæƒå¤„æ–‡ç« æ°¸ä¹…é“¾æ¥ï¼‰
   */
  url: string
  /**
   * Site title
   * @description ç«™ç‚¹æ ‡é¢˜
   */
  title: string
  /**
   * å‰¯æ ‡é¢˜
   */
  subtitle: string
  /**
   * ç«™ç‚¹æè¿°
   */
  description: string
  /**
   * The owner of this blog
   * @description åšå®¢ä½œè€…
   */
  author: {
    /**
     * Your name
     * @description ä½ çš„åå­—
     */
    name: string
    email: string
    link: string
    avatar: string
    /**
     * The status of you
     * @description çŠ¶æ€
     */
    status: {
      emoji: string
      /**
       * show when hover emoji
       * @description å½“é¼ æ ‡æ‚¬æµ®åœ¨å›¾æ ‡ä¸Šæ—¶æ˜¾ç¤º
       */
      message: string
    }
  }

  /**
   * icon for your website
   */
  favicon: string

  feed: {
    /**
     * name: feed -> feed.xml / feed.atom / feed.json
     * @default '' -> feed.xml / atom.xml / feed.json
     */
    name: string
    favicon: string
  }

  /**
   * ç¤¾äº¤é“¾æ¥
   */
  social: SocialLink[]

  /**
   * search
   */
  search: {
    algolia: {
      enable: boolean
      appId: string
      apiKey: string
      indexName: string
      chunkSize: number
    }
  }

  /**
   * comment: waline/...
   */
  comment: {
    waline: {
      enable: boolean
      serverURL: string
    }
    twikoo: {
      enable: boolean
      envId: string
    }
  }

  /**
   * The name of theme
   * @description ä¸»é¢˜åç§°
   */
  theme: string
  /**
   * The config of theme
   * @description ä¸»é¢˜é…ç½®
   */
  themeConfig: T & {
    pkg: {
      name: string
      version: string
      homepage?: string
      [key: string]: any
    }
  }

  /**
   * Unocss Config
   */
  unocss: VitePluginConfig

  /**
   * The license of your posts
   * @description æ–‡ç« æ‰€ä½¿ç”¨çš„åè®®ï¼Œé»˜è®¤ä½¿ç”¨ Creative Commons
   * @default https://creativecommons.org/licenses/
   */
  license: {
    /**
     * Whether to show at the bottom of the article
     * @description æ˜¯å¦æ˜¾ç¤ºåœ¨æ–‡ç« åº•éƒ¨
     * @default true
     */
    enabled: boolean
    /**
     * Creative License Language, same with your config.lang
     * when lang === 'zh-CN', use 'zh'
     * @description é»˜è®¤ä¸ç«™ç‚¹è¯­è¨€ç›¸åŒ
     * @default 'en'
     */
    language: string
    /**
     * Type of license
     * @description è¯ä¹¦ç±»å‹
     * @default 'by-nc-sa'
     */
    type: 'zero' | 'by-sa' | 'by-nd' | 'by-nc' | 'by-nc-sa' | 'by-nc-nd'
  }

  /**
   * donate for author
   * @description æ‰“èµ/èµåŠ©
   */
  sponsor: {
    enable: boolean
    title: string
    methods: {
      name: string
      url: string
      color: string
      icon: string
    }[]
  }

  /**
   * cover
   * @description å°é¢
   */
  cover: {
    enable: boolean
    alt: string
    defaultUrl: string
  }

  /**
   * for markdown
   */
  markdown: ViteMdOptions
  markdownIt: MarkdownOptions
}

/**
 * Valaxy User Config
 * @description Valaxy ç”¨æˆ·é…ç½®
 */
export type UserConfig<T = ValaxyThemeConfig> = PartialDeep<ValaxyConfig<T>>

export const defaultValaxyConfig: ValaxyConfig = {
  url: '',
  lang: 'en',
  title: 'Valaxy Blog',
  description: 'A blog generated by Valaxy.',
  subtitle: 'Next Generation Static Blog Framework.',
  author: {
    avatar: 'https://cdn.jsdelivr.net/gh/YunYouJun/yun/images/meme/yun-good-with-bg.jpg',
    email: 'me@yunyoujun.cn',
    link: 'https://www.yunyoujun.cn',
    name: 'YunYouJun',
    status: {
      emoji: 'ğŸ˜Š',
      message: 'All at sea.',
    },
  },
  favicon: 'favicon.svg',
  feed: {
    name: '',
    favicon: 'favicon.svg',
  },
  social: [],

  license: {
    enabled: true,
    language: '',
    type: 'by-nc-sa',
  },

  sponsor: {
    enable: true,
    title: 'æˆ‘å¾ˆå¯çˆ±ï¼Œè¯·ç»™æˆ‘é’±',
    methods: [
      {
        name: 'æ”¯ä»˜å®',
        url: 'https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/donate/alipay-qrcode.jpg',
        color: '#00A3EE',
        icon: 'i-ri-alipay-line',
      },
      {
        name: 'QQ æ”¯ä»˜',
        url: 'https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/donate/qqpay-qrcode.png',
        color: '#12B7F5',
        icon: 'i-ri-qq-line',
      },
      {
        name: 'å¾®ä¿¡æ”¯ä»˜',
        url: 'https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/donate/wechatpay-qrcode.jpg',
        color: '#2DC100',
        icon: 'i-ri-wechat-pay-line',
      },

    ],
  },

  search: {
    algolia: {
      enable: false,
      appId: '',
      apiKey: '',
      indexName: '',
      chunkSize: 5000,
    },
  },

  comment: {
    waline: {
      enable: false,
      serverURL: '',
    },
    twikoo: {
      enable: false,
      envId: 'https://twikoo.vercel.app',
    },
  },

  theme: 'yun',
  themeConfig: {
    pkg: {
      name: '',
      version: '',
    },
  },

  unocss: {},

  markdown: {
    excerpt: '<!-- more -->',
  },
  markdownIt: {
    toc: {
      includeLevel: [1, 2, 3, 4],
      listType: 'ol',
    },
    katex: {},
  },
  cover: {
    enable: true,
    alt: 'ç…æˆ‘å¹²å•¥ï¼',
    defaultUrl: 'https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/bg/galaxy.jpg',
  },
}
